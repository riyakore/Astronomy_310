\documentclass[10pt]{article}
% set this variable to the assignment number
\def \HWNUM{n}
\def \Sus{\begin{tikzpicture}
\amongUsIII[scale=.05]{red}{blue}
\end{tikzpicture}}
\newcommand{\bigpare}[1]{\left( {#1}\right)}
\newcommand{\MatTwo}[4]{\begin{bmatrix}
{#1} & {#2}\\
{#3} & {#4}
\end{bmatrix}}
\newcommand{\MatThree}[9]{\begin{bmatrix}
 {#1}&{#2}&{#3}\\
 {#4}&{#5}&{#6}\\
 {#7}&{#8}&{#9}
\end{bmatrix}}
\newcommand{\VectorTwo}[2]{\begin{bmatrix}
{#1}\\
{#2}
\end{bmatrix}}
\newcommand{\VectorThree}[3]{\begin{bmatrix}
{#1}\\
{#2}\\
{#3}
\end{bmatrix}}
% set this variable to your name
\def \MYID{Riya Kore}
\usepackage{tocloft}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{eufrak}
\usepackage{color}
\usepackage{tikz}
\usepackage{tikz-among-us}
\usepackage{fancyhdr}
\usepackage{pgf}
\usepackage{pgfplots}
\usepackage{color}
\usepackage{graphicx}
\usepackage{titlesec}
\usepackage{bm}
\usepackage{listings}
\usepackage{listing}
\usepackage{ gensymb }
\usepackage{ wasysym }
\usepackage{float}
\lstset{ %
language=python,
commentstyle=\color{yellow!80!red},
keywordstyle=\color{blue!50!white},
stringstyle=\color{green!80!white},
identifierstyle=\color{red!50!white},
basicstyle=\small\ttfamily,
showstringspaces=false
}
\topmargin -0.7in
\oddsidemargin -0.25in
\evensidemargin -0.25in
\textwidth 7in
\textheight 9in
\begin{document}

% \fancypagestyle{headings}{% changes predefined style
% \fancyhf{} % clear all header and footer fields
% \fancyfoot[C]{%
% \begin{tikzpicture}
%     \amongUsI[rotate around={45*(\thepage-2):(1.75,2.3)},
%     scale=0.25, shift={(5,7)}]{red}{cyan};
%     \node at (1.75,2.3) {\thepage};
% \end{tikzpicture}}
% \renewcommand{\headrulewidth}{0pt} % remove line between header and main text
% }
\pagestyle{fancy}
\fancyhf{}
\fancyfoot[C]{\thepage}

\title{Astronomy 310 Homework 6}
\author{\MYID\\
University of Wisconsin-Madison}
\date{\today}
\maketitle

\section*{Problem 1}
For the solar model introduced MESA-Web demonstration in class last Thursday, create a Python plot of $log(L/L_{\astrosun})$ as a function of $log(t/yr)$ , where t is the time since the start of the MESA-Web calculation. Be sure to label your axes appropriately. Attach this plot to your submission. (Don’t include the code you used to create this plot.). From your plot, estimate by what factor the Sun’s luminosity has increased over the period extending from the pre-main sequence luminosity minimum at $log(t/yr) \approx 7.10$ through to the present day.
\\ \\
Solution:\\
The plot generated by the data from MESA-Web is:
\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{hw_6_astron_310_q1.png}
    \caption{Luminosity vs star age}
    \label{fig:enter-label}
\end{figure}
\\ \\
From the graph, when the value of log(t/yr) is 7.10, the value of log($L/L_{\astrosun}$) is -0.36706512644252737. 
To find the luminosity, we take the antilog of this value.
\[ 10^{-0.3671} = 0.42947\]
This means that the sun's luminosity during the pre-main sequence evolution phase is 0.42943 $L_{\astrosun}$\\
The current luminosity of the sun is 1 $L_{\astrosun}$. \\
The fraction of the sun's luminosity right now as compared to the pre-main sequence evolution is given by:
\[ \frac{1 L_{\astrosun}}{0.42947 L_{\astrosun}} = 2.3284\]
This tells us that the sun's luminosity increased by a factor of 2.3284 from the pre-main sequence luminosity when we compare it to sun's present day luminosity.

\section*{Problem 2}
For a sample of pure hydrogen,write an expression relating the total number density of particles n to the number densities of hydrogen atoms/ions $(n_{H})$ and free electrons $(n_{e})$. Use this expression, and others appearing in Handout 17, to rewrite equation [17.7] for the ionization fraction x in terms of n and T. Then, evaluate the ionization fraction at a temperature 10 K and pressure $10^{5}$ Ba. (You may neglect radiation pressure and assume the atoms, ions and electrons behave classically). How does the ionization fraction change if the temperature is doubled? Or if the pressure is doubled?\\ \\
Solution:\\
The total number density of particles for a sample of pure hydrogen is given by:
\[ n = n_{H} + n_{e} \]
The ionization factor is given by:
\[ x = \frac{n_{e}}{n_{H}}\]
\[ n_{e} = x n_{H}\]
Plugging this in the above equation, we get:
\[ n = n_{H} + xn_{H}\]
\[ n_{H} = \frac{n}{x+1}\]
Now, Saha's equation [17.7] is given by:
\[ \frac{x^2}{1-x} = \frac{(2\pi m_{e} k_{B} T)^{3/2}}{n_{H} h^3} e^{-\chi_{H}/k_{B}T}\]
We can put the value of $n_{H}$ in terms of n and x in the above equation. Thus we get:
\[ \frac{x^2}{1-x} = \frac{(2\pi m_{e} k_{B} T)^{3/2}}{n h^3} (x+1) \ e^{-\chi_{H}/k_{B}T}\]
\[ \frac{x^2}{1-x^2} = \frac{(2\pi m_{e} k_{B})^{3/2} (T)^{3/2}}{n h^3} \ e^{-\chi_{H}/k_{B}T}\]
\[ x^2 = \frac{(2\pi m_{e} k_{B})^{3/2} (T)^{3/2}}{n h^3} \ e^{-\chi_{H}/k_{B}T} - \frac{(2\pi m_{e} k_{B})^{3/2} (T)^{3/2}}{n h^3} \ e^{-\chi_{H}/k_{B}T} \ x^2\]
\[ x^2(1 + \frac{(2\pi m_{e} k_{B})^{3/2} (T)^{3/2}}{n h^3} \ e^{-\chi_{H}/k_{B}T}) = \frac{(2\pi m_{e} k_{B})^{3/2} (T)^{3/2}}{n h^3} \ e^{-\chi_{H}/k_{B}T} \]\\
\[ x^2 = \frac{\frac{(2\pi m_{e} k_{B})^{3/2} (T)^{3/2}}{n h^3} \ e^{-\chi_{H}/k_{B}T}}{(1 + \frac{(2\pi m_{e} k_{B})^{3/2} (T)^{3/2}}{n h^3} \ e^{-\chi_{H}/k_{B}T})}\]\\
\begin{equation}
    x = \sqrt{\frac{\frac{(2\pi m_{e} k_{B})^{3/2} (T)^{3/2}}{n h^3} \ e^{-\chi_{H}/k_{B}T}}{(1 + \frac{(2\pi m_{e} k_{B})^{3/2} (T)^{3/2}}{n h^3} \ e^{-\chi_{H}/k_{B}T})}}  \tag{1}
\end{equation}
The sample of gas is made up purely of hydrogen, so we can treat it like an ideal gas. The ideal gas equation of state is given by:
\[ P = n k_{B} T\]
\[ n = \frac{P}{k_{B} T}\]
We can substitute the value of n in equation (1) to get:
\[ x = \sqrt{\frac{\frac{(2\pi m_{e} k_{B})^{3/2} (T)^{3/2}}{n h^3} \ e^{-\chi_{H}/k_{B}T}}{(\frac{P h^3}{k_{B}T} + \frac{(2\pi m_{e} k_{B})^{3/2} (T)^{3/2}}{n h^3} \ e^{-\chi_{H}/k_{B}T})}} \]
Looking at this equation, we see that the exponential term evaluates to $e^{-15789.09}$. This is such a small number that we might as well assume it to be 0. From this assumption, we can see that $x \approx 0$.
This answer agrees with Figure [17.1] in the handout.\\ \\
(Correction) If the temperature is $10^4 \ K$ instead of 10 K, we can evaluate the value for x.
\[ x = \sqrt{\frac{\frac{(2\pi m_{e} k_{B})^{3/2} (T)^{3/2}}{n h^3} \ e^{-\chi_{H}/k_{B}T}}{(\frac{P h^3}{k_{B}T} + \frac{(2\pi m_{e} k_{B})^{3/2} (T)^{3/2}}{n h^3} \ e^{-\chi_{H}/k_{B}T})}} \]\\
\[ x = \sqrt{\frac{7.026*10^{-58}*1.3785*10^{-7}}{2.1167*10^{-62}}}\]\\
\[ x = \sqrt{\frac{9.685 * 10^{-65}}{2.1167 * 10^{-62}}}\]\\
\[ x = 0.0676\]
This value also agrees with Figure [17.1].\\ \\
If the temperature of the gas sample is doubled, we find that the ionization fraction increases by a factor of $2^{5/2}e^{-1/2}$. We can plug the new value for temperature in the expression for x to confirm that the ionization fraction indeed increases.\\ \\
If the pressure of the gas sample is doubled, we find that the ionization fraction decreases by a factor of 2. We can plug the new value for pressure in the above expression of x to check this. \\
\section*{Problem 3}
Consider an ideal-gas star whose pressure and density follow the poltropic relation
\begin{equation}
    P = K \rho^{(n+1)/n} \tag{1}
\end{equation}
(a) Derive an expression for the temperature in terms of the pressure P and other constant quantities $(K , n, \mu, etc.)$.\\ \\
For an ideal gas, we can write an expression for pressure in terms of density and temperature as:
\[P = \frac{\rho k_{B} T}{\mu m_{H}}\]
From this, we can get density in terms of pressure and temperature as:
\begin{equation}
    \rho = \frac{P \mu m_{H}}{k_{B} T}  \tag{2}
\end{equation}
We can plug in the expression for density from equation (2) in equation (1) to get:
\[ P = K (\frac{P \mu m_{H}}{k_{B} T})^{\frac{n + 1}{n}}\]
Rearranging this, we can get temperature in terms of pressure and other constants as:
\begin{equation}
    T = (K)^{\frac{n}{1+n}} (P)^{\frac{1}{1+n}} \frac{\mu m_{H}}{k_{B}} \tag{3}
\end{equation}
\\ \\
(b) Evaluate the dimensionless temperature gradient $\triangledown_{T}$.\\ \\
If we take the natural log on both sides of equation (3), we get the expression:
\[ \ln{T} = \frac{n}{1+n} \ln{(K)} + \frac{1}{1+n} \ln{(P)} + \ln{(\frac{\mu m_{H}}{k_{B}})}\]
Partially differentiating both sides of the above expression, we get:
\[ \partial \ln{T} = 0 + \frac{1}{1+n} \partial \ln{P} + 0\]
This gives us:
\[ \frac{\partial \ln{T}}{\partial \ln{P}} = \frac{1}{1+n}\]
Thus we get the dimensionless temperature gradient as:
\[ \triangledown_{T} = \frac{1}{1+n}\]
\\ \\
(c) Assuming that $\gamma = 5/3$, show that the star is convectively stable everywhere if n $>$ 1.5, and convectively unstable everywhere if n $<$ 1.5. \\ \\
The Schwarzchild criterion for convective stability states that $\triangledown_{T} < \triangledown_{ad}$ should be true for the star to be stable, and if this inequality is violated, then the star becomes unstable and convection will commence.\\
To find $\triangledown_{ad}$ we can use:
\[ \triangledown_{ad} = \frac{\gamma - 1}{\gamma}\]
\[ \triangledown_{ad} = \frac{2}{5}\]
To check for stability, we need:
\[ \triangledown_{T} < \triangledown_{ad}\]
\[ \frac{1}{1+n} < \frac{2}{5}\]
Solving this equation, we get:
\[ n > \frac{3}{2}\]
This means that for all values of n $>$ 3/2, the star will be convectively stable as the Schwarzchild criterion holds true.\\
For all values of n $<$ 3/2, the Schwarzchild criterion gets violated and the material in the star becomes unstable, and convection is commence.
\\ \\
\section*{Problem 4}
Consider an n = 1 polytrope with mass M and radius R.\\ \\
(a) Write down an expression for the central density $\rho_{c}$ in terms of M and R. (Hint: Apply eqn. [19.11], using the analytic solution for n = 1 to evaluate the term in parentheses.) \\ \\
The expression for density is given by:
\begin{equation}
   \rho_{c} = \frac{1}{4 \pi} \frac{M}{R^3} (\frac{-1}{z} \frac{dw}{dz})^{-1}   \tag{1}
\end{equation}
For n = 1 polytrope, $z_{s} = \pi$ and $\omega(z) = \frac{sin(z)}{z}$. From this, we can evaluate dw/dz to be:
\[ \frac{dw}{dz} = \frac{(z cos(z) - sin(z))}{z^2}\]
When $z = z_{s}$, we get:
\[ \frac{dw}{dz} = \frac{-1}{\pi}\]
Plugging in the values for $z_{s}$ and $dw/dz$ in equation (1), we get:
\[ \rho_{c} = \frac{1}{4\pi} \frac{M}{R^3} \left(\frac{-1}{\pi} \left(\frac{-1}{\pi}\right)\right)^{-1}\]
\[ \rho_{c} = \frac{1}{4\pi} \frac{M}{R^3} \pi^2\]
\begin{equation}
    \rho_{c} = \frac{M \pi}{4 R^3}  \tag{2}
\end{equation}
\\
Equation (2) gives you the central density in terms of M and R.
\\ \\
(b) Evaluate the ratio $(\rho_{c}/\bar{\rho})$, where $\bar{\rho} = 3M/(4 \pi R^3)$ is the mean density. Is this ratio larger or smaller than for an n = 0 (constant density) polytrope?\\ \\
For n = 1 polytrope, the ratio of $(\rho_{c}/\bar{\rho})$ will be:
\[ \left(\frac{\rho_{c}}{\bar{\rho}}\right)_{n = 1} = \frac{M \pi}{4 R^3} \div \frac{4 \pi R^3}{3 M}\]
Solving this yields us the answer:
\begin{equation}
    \left(\frac{\rho_{c}}{\bar{\rho}}\right)_{n = 1} = \frac{\pi^{2}}{3} = 3.2867  \tag{3}
\end{equation}
We need to compare this result with the constant density polytrope. To find it, we need to compute $\rho_{c}$ when n = 0.\\
When n = 0, $z_{s} = \sqrt{6}$ and $\omega(z) = 1 - \left( \frac{z^2}{6}\right)$ \\
So, 
\[ \left( \frac{dw}{dz}\right)_{n=0} = 0 - \frac{2z}{6}\]
When, z = $z_{s}$
\[ \left( \frac{dw}{dz}\right)_{n=0} = \frac{- \sqrt{6}}{3}\]
We can plug these values in equation (1) to find out the central density for n = 0.
\[ \rho_{c} = \frac{1}{4 \pi} \frac{M}{R^3} \left( \frac{-1}{\sqrt{6}} *\frac{-\sqrt{6}}{3}\right)^{-1}\]
\[ \rho_{c} = \frac{3M}{4 \pi R^3}\]
So, the ratio for $(\rho_{c}/\bar{\rho})$ for n = 0 becomes:
\begin{equation}
       \left( \frac{\rho_{c}}{\bar{\rho}}\right)_{n=0} = \frac{3M/4\pi R^3}{3M/4\pi R^3}  = 1 \tag{4}
\end{equation}
Looking at equation (3) and (4) we get:
\[ \left(\frac{\rho_{c}}{\bar{\rho}}\right)_{n = 1} > \left( \frac{\rho_{c}}{\bar{\rho}}\right)_{n=0}\]
Thus, the ratio for the n = 1 polytrope is larger than that of the n = 0 polytrope.
\\ \\
(c) Derive an expression for the interior mass m, in terms of M, R and r. \\ \\
The expression for interior mass is given by:
\[ m(r) = 4 \pi \rho_{c} r^3 \left( \frac{-1}{z} \frac{dw}{dz}\right)\]
From the handout, we know that:
\[ z = \left( \frac{4 \pi G}{K \rho^{\frac{1-n}{n}} (n+1)}\right)^{1/2} r\]
For n = 1, z becomes:
\[ z = \left( \frac{2 \pi G}{K}\right)^{1/2} r\]
$z_{s}$ for n = 1 is given by:
\[ z_{s} = \left( \frac{2 \pi G}{K}\right)^{1/2} R\]
So,
\[ \frac{z}{z_{s}} = \frac{r}{R}\]
We know the value of $z_{s} = \pi$ for n = 1. so we get:
\[ z = \frac{\pi r}{R}\] 
We can plug the values of z, dw/dz and $\rho_{c}$ in the interior mass equation to get:
\[ m(r) = 4 \pi \rho_{c} r^3 \left( \frac{-1}{z} \left( \frac{(z cos(z) - sin(z))}{z^2}\right)\right)\]
\[ m(r) = 4 \pi \frac{M \pi}{4 R^3} r^3 \left( \frac{-R}{\pi r} \left( \frac{(\frac{\pi r}{R} cos(\pi r/R) - sin(\pi r / R))}{(\pi r / R)^{2}}\right)\right)\]
Simplifying this, you get:
\begin{equation}
    m(r) = \frac{M \pi^2}{R^3} r^3 \left( \frac{-R^3}{\pi^3 r^3} \left( \frac{\pi r }{R} cos(\frac{\pi r}{R}) - sin(\frac{\pi r}{R})\right) \right) \tag{5}
\end{equation}
Equation (5) gives us the expression for interior mass in terms of M, R and r for an n = 1 polytrope.
\\ \\
(d) Use your m(r) expression to confirm that 
\[ m(R/2) =  \frac{M}{\pi}\] \\ \\
In equation (5), let's replace r with R/2 to solve for m(R/2). We get:
\[ m(R/2) = \frac{M \pi^2}{R^3} \frac{R^3}{8} \left( \frac{-R^3 8}{\pi^3 r^3} \left( \frac{\pi R }{2R} cos(\frac{\pi R}{2R}) - sin(\frac{\pi R}{2R})\right) \right)\]
Solving this, we can get:
\[ m(R/2) = \frac{M \pi^2}{8} \left( \frac{-8}{\pi^3} -1\right)\]
\[ m(R/2) = \frac{M \pi^2}{8} \frac{8}{\pi^3}\]
\[ m(R/2) = \frac{M}{\pi}\]
After solving equation (5) for the specific value of R/2, I was able to prove that for n = 1 polytrope, m(R/2) = $M/\pi$. This means that our equation from part (c) for the interior mass is correct.
\\ \\
\section*{Problem 5}
Use Poly-Web to create models for n = 0 and n = 1 polytropes. For each model, plot a graph of w versus $z/z_{s}$, and (using a dashed line-style) also show the corresponding analytic solution. Do the Poly-Web and analytic solutions agree? Attach this plot to your submission. \\ \\
The following information may prove useful:\\
\begin{itemize}
    \item To use Poly-Web,fill in the Polytropic Index box with the desired value of n, and and hit the Submit button. Save the resulting model (a three-column table of data) to disk.
    \item To read a model into Python, use the following code:\\
    import numpy as np\\
    data = loadtxt(filename)\\
    z = data[:,0]\\
    w = data[:,1]\\
    $dw\_dt$ = data[:,2]\\
    (where, filename is the name of the file you saved the model to.)
    \item To plot a dashed line, ad ls = '--' argument to your plt.plot() command.
\end{itemize}

Here are the plots for n = 0 polytrope:
\begin{figure}[H]
    \centering
    \includegraphics[width=0.4\textwidth]{polytrope_n_0_numerical.png}
    \caption{Numerical plot for n = 0 polytrope}
    \label{fig:enter-label}
\end{figure}
We can plot the same function using an analytical approach. For n = 0, the function of w as a function of $z/z_{s}$ is given by:
\[ w(z) = 1 - z^2\]
Plotting this on the graph gets us:

\begin{figure}[H]
    \centering
    \includegraphics[width=0.4\textwidth]{polytrope_n_0_analytical.png}
    \caption{Analytical plot for n = 0 polytrope}
    \label{fig:enter-label}
\end{figure}

If we plot both of these on the same graph, the plots should match. Thus we get:

\begin{figure}[H]
    \centering
    \includegraphics[width=0.4\textwidth]{polytrope_n_0.png}
    \caption{Combined plots of numerical and analytical for n = 0 polytrope}
    \label{fig:enter-label}
\end{figure}

We can do the same for n = 1 polytrope.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.4\textwidth]{polytrope_n_1_numerical.png}
    \caption{Numerical plot for n = 1 polytrope}
    \label{fig:enter-label}
\end{figure}

For n = 1, the function of w as a function of z is given by:
\[ w(z) = \frac{sin(z)}{z}\]
This doesn't give me w for $z/z_{s}$, so I had to convert the x co-ordinates to $z/z_{s}$. I simply divided all the elements in z array by 3.14159 to get all the points for plotting on the x axis. Plotting this on the graph gets us:

\begin{figure}[H]
    \centering
    \includegraphics[width=0.4\textwidth]{polytrope_n_1_analytical.png}
    \caption{Analytical plot for n = 1 polytrope}
    \label{fig:enter-label}
\end{figure}

If we plot both of these on the same graph, the plots should match. Thus we get:

\begin{figure}[H]
    \centering
    \includegraphics[width=0.4\textwidth]{polytrope_n_1.png}
    \caption{Combined plots of numerical and analytical for n = 1 polytrope}
    \label{fig:enter-label}
\end{figure}

From this we can conclude that the Poly-Web and the analytic solutions agree. 
\end{document}